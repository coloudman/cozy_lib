!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){var i;
/*!
 * EventEmitter v5.2.8 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(e){"use strict";function r(){}var s=r.prototype,o=e.EventEmitter;function a(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function u(t){return function(){return this[t].apply(this,arguments)}}s.getListeners=function(t){var e,n,i=this._getEvents();if(t instanceof RegExp)for(n in e={},i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n]);else e=i[t]||(i[t]=[]);return e},s.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},s.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&((e={})[t]=n),e||n},s.addListener=function(t,e){if(!function t(e){return"function"==typeof e||e instanceof RegExp||!(!e||"object"!=typeof e)&&t(e.listener)}(e))throw new TypeError("listener must be a function");var n,i=this.getListenersAsObject(t),r="object"==typeof e;for(n in i)i.hasOwnProperty(n)&&-1===a(i[n],e)&&i[n].push(r?e:{listener:e,once:!1});return this},s.on=u("addListener"),s.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},s.once=u("addOnceListener"),s.defineEvent=function(t){return this.getListeners(t),this},s.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},s.removeListener=function(t,e){var n,i,r=this.getListenersAsObject(t);for(i in r)r.hasOwnProperty(i)&&-1!==(n=a(r[i],e))&&r[i].splice(n,1);return this},s.off=u("removeListener"),s.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},s.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},s.manipulateListeners=function(t,e,n){var i,r,s=t?this.removeListener:this.addListener,o=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)s.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?s.call(this,i,r):o.call(this,i,r));return this},s.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if(t instanceof RegExp)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},s.removeAllListeners=u("removeEvent"),s.emitEvent=function(t,e){var n,i,r,s,o=this.getListenersAsObject(t);for(s in o)if(o.hasOwnProperty(s))for(n=o[s].slice(0),r=0;r<n.length;r++)!0===(i=n[r]).once&&this.removeListener(t,i.listener),i.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},s.trigger=u("emitEvent"),s.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},s.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},s._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},s._getEvents=function(){return this._events||(this._events={})},r.noConflict=function(){return e.EventEmitter=o,r},void 0===(i=function(){return r}.call(e,n,e,t))||(t.exports=i)}("undefined"!=typeof window?window:this||{})},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(0));class s extends r.default{constructor(){super(),this.linkingPoints={}}addLinkingPoint(t){const e=this.linkingPoints[t]=this.createLinkingPoint();return this.emit("added",t,e),e}removeLinkingPoint(t){delete this.linkingPoints[t],this.emit("removed",t)}link(t,e){return this.linkingPoints[t].link(e)}unlink(t){this.linkingPoints[t].unlink()}getLinkingPoint(t){return this.linkingPoints[t]}getLinked(t){return this.linkingPoints[t].linked}getLinkingPoints(){return this.linkingPoints}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(0));class s extends r.default{constructor(){super(),this.linked=void 0}link(t){return this.linked=this.loadData(t),this.emit("linked",this.linked,t),this.linked}unlink(){this.linked=void 0,this.emit("unlinked")}}e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.packages=t}}},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(5));e.Code=r.default;const s=i(n(10));e.Controller=s.default;const o=i(n(3));e.Loader=o.default;const a=i(n(11));e.CodeLoader=a.default;const u=i(n(12));e.ControllerLoader=u.default;const l=i(n(2));e.LinkingPoint=l.default;const c=i(n(13));e.Context=c.default;const d=i(n(14));e.Area=d.default;const f=i(n(1));e.LinkingPointsManager=f.default},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(6)),s=i(n(8));e.default=class{constructor(t,e,n,i){this.codeData=n,this.codeLoader=t,this.controllerLoaders=e,this.contexts=i,this.codeLinkingPointsManager=new r.default(t),this.controllerLinkingPointsManagers={},this.controllers={},this.data=n.data,this.codeLinkingPointsManager.on("added",(t,e)=>{e.on("linked",(e,n)=>{Object.entries(this.controllerLinkingPointsManagers).forEach(([n,i])=>{i.link(t,e.addController(n))}),this.codeData.linkingPointsData[t]=n}).on("unlinked",()=>{Object.values(this.controllerLinkingPointsManagers).forEach(e=>{e.unlink(t)}),delete this.codeData.linkingPointsData[t]}),Object.values(this.controllerLinkingPointsManagers).forEach(e=>{e.addLinkingPoint(t)})}),this.codeLinkingPointsManager.on("removed",t=>{Object.values(this.controllerLinkingPointsManagers).forEach(e=>{e.removeLinkingPoint(t)})}),Object.entries(n.linkingPointsData).forEach(([t,e])=>{this.addLinkingPoint(t),this.link(t,e)})}runOnExistLinkingPoints(t){Object.entries(this.codeLinkingPointsManager.getLinkingPoints()).forEach(([e,n])=>{n.linked&&t(e,n.linked)})}addController(t){const e=this.controllerLinkingPointsManagers[t]=new s.default;Object.entries(this.codeLinkingPointsManager.linkingPoints).forEach(([n,i])=>{e.addLinkingPoint(n),i.linked&&e.link(n,i.linked.addController(t))});const n=this.codeData.controllerDatas[t]||(this.codeData.controllerDatas[t]={}),i=this.controllerLoaders[t].load({code:this,iD:this.codeData.iD,data:n,context:this.contexts[t],linkingPointsManager:e});return this.controllers[t]=i,i}removeController(t,e=!1){this.runOnExistLinkingPoints((e,n)=>{n.removeController(t)}),delete this.controllerLinkingPointsManagers[t],this.controllers[t].stop(),delete this.controllers[t],e&&delete this.codeData.controllerDatas[t]}addLinkingPoint(t){return this.codeLinkingPointsManager.addLinkingPoint(t)}removeLinkingPoint(t){return this.codeLinkingPointsManager.removeLinkingPoint(t)}addDefaultLinkingPoints(t){t.forEach(t=>{this.codeLinkingPointsManager.getLinkingPoint(t)||this.addLinkingPoint(t)})}link(t,e){return this.codeLinkingPointsManager.link(t,e)}unlink(t){return this.codeLinkingPointsManager.unlink(t)}getLinkingPoints(){return this.codeLinkingPointsManager.linkingPoints}getLinkingPoint(t){return this.codeLinkingPointsManager.getLinkingPoint(t)}getLinked(t){return this.codeLinkingPointsManager.getLinked(t)}}},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(1)),s=i(n(7));class o extends r.default{constructor(t){super(),this.codeLoader=t}createLinkingPoint(){return new s.default(this.codeLoader)}}e.default=o},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(2));class s extends r.default{constructor(t){super(),this.codeLoader=t}loadData(t){return this.codeLoader.load(t)}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(1)),s=i(n(9));class o extends r.default{constructor(){super()}createLinkingPoint(){return new s.default}}e.default=o},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(2));class s extends r.default{constructor(){super()}loadData(t){return t}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(0));class s extends r.default{constructor(t,e,n,i){super(),this.code=t,this.linkingPointsManager=i,this.data=e,this.context=n,this.emit("init")}getLinkingPoints(){return this.linkingPointsManager.linkingPoints}getLinkingPoint(t){return this.linkingPointsManager.getLinkingPoint(t)}getLinked(t){return this.linkingPointsManager.getLinked(t)}stop(){this.emit("stop")}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(3));class s extends r.default{constructor(t,e,n){super(t),this.controllerLoaders=e,this.contexts=n}load(t){return new(0,Object.values(this.packages).find(e=>t.iD.packageId===e.id&&t.iD.packageVersion===e.version).body[t.iD.id])(this,this.controllerLoaders,t,this.contexts)}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(3));class s extends r.default{load({code:t,iD:e,data:n,context:i,linkingPointsManager:r}){return new(0,Object.values(this.packages).find(t=>e.packageId===t.for_id&&e.packageVersion===t.for_version).body[e.id])(t,n,i,r)}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(0));class s extends r.default{constructor(t){super(),this.data=t}}e.default=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(n(0));class s extends r.default{constructor(t,e,n,i){super(),this.codeLoader=t,this.controllerLoaders=e,this.contexts=i,this.codes=[],this.controllerNames=[],this.codeDatas=n,n.forEach(t=>{this.addCode(t)})}addCode(t){const e=this.codeLoader.load(t);return this.controllerNames.forEach(t=>{e.addController(t)}),this.codes.push(e),this.codeDatas.push(t),this.emit("codeAdded",e),e}removeCode(t){const e=this.codes.indexOf(t);this.codes.splice(e,1),this.codeDatas.splice(e,1),this.emit("codeRemoved",t)}getController(t){const e=[];return this.codes.forEach(n=>{e.push(n.controllers[t])}),e}addController(t){this.codes.forEach(e=>{e.addController(t)}),this.controllerNames.push(t)}}e.default=s}]));